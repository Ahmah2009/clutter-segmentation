#!/usr/bin/env Rscript
library(RSQLite)
con = dbConnect(dbDriver("SQLite"), dbname = Sys.getenv("CLUTSEG_EXPERIMENT_DB"))
f = dbGetQuery(con, "select experiment_id, succ_rate from view_experiment_response order by succ_rate DESC limit 1")
attach(f)
artifact_dir = Sys.getenv("CLUTSEG_ARTIFACT_DIR")
png(paste(artifact_dir, "/best_succ_rate.png", sep=""))
barplot(matrix(c(succ_rate, 1-succ_rate), 2, 1), names.arg=c("Best Success Rate"), horiz=TRUE, col=c("GREEN", "RED"))
system(gettextf("result-montage refine_choice.collage %d", experiment_id[1]))
system(gettextf("convert %s/refine_choice.collage.%05d.jpg -resize %%20 %s/best_succ_rate.refine_choice.collage.jpg", artifact_dir, experiment_id[1], artifact_dir))
